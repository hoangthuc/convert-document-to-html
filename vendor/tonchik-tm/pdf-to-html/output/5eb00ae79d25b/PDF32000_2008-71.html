<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
<title>Page 71</title>

<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft00{font-size:9px;font-family:Times;color:#000000;}
	.ft01{font-size:14px;font-family:Times;color:#000000;}
	.ft02{font-size:12px;font-family:Times;color:#000000;}
	.ft03{font-size:12px;font-family:Times;color:#000000;}
	.ft04{font-size:12px;font-family:Times;color:#000000;}
	.ft05{font-size:11px;font-family:Times;color:#000000;}
	.ft06{font-size:12px;line-height:17px;font-family:Times;color:#000000;}
	.ft07{font-size:12px;line-height:17px;font-family:Times;color:#000000;}
	.ft08{font-size:11px;line-height:15px;font-family:Times;color:#000000;}
-->
</style>
</head>
<body bgcolor="#A0A0A0" vlink="blue" link="blue">
<div id="page71-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="src/../output/5eb00ae79d25b/PDF32000_2008071.png" alt="background image"/>
<p style="position:absolute;top:1199px;left:106px;white-space:nowrap" class="ft00">©&#160;</p>
<p style="position:absolute;top:1196px;left:118px;white-space:nowrap" class="ft01"><b>Adobe Systems Incorporated&#160;2008 – All rights&#160;reserved</b></p>
<p style="position:absolute;top:1197px;left:821px;white-space:nowrap" class="ft02">63</p>
<p style="position:absolute;top:63px;left:697px;white-space:nowrap" class="ft01"><b>PDF 32000-1:2008</b></p>
<p style="position:absolute;top:127px;left:106px;white-space:nowrap" class="ft02">d)</p>
<p style="position:absolute;top:127px;left:135px;white-space:nowrap" class="ft06">Create&#160;an&#160;RC4&#160;encryption&#160;key using&#160;the&#160;first&#160;<i>n</i>&#160;bytes of&#160;the output from&#160;the&#160;final&#160;MD5 hash, where&#160;<i>n</i>&#160;shall&#160;<br/>always be&#160;5 for&#160;security handlers&#160;of revision&#160;2&#160;but, for security&#160;handlers of revision&#160;3 or&#160;greater, shall&#160;<br/>depend on the value of the&#160;encryption dictionary’s&#160;<b>Length</b>&#160;entry.&#160;</p>
<p style="position:absolute;top:197px;left:106px;white-space:nowrap" class="ft02">e)</p>
<p style="position:absolute;top:197px;left:135px;white-space:nowrap" class="ft06">Pad or&#160;truncate&#160;the&#160;user password&#160;string&#160;as&#160;described in&#160;<a href="src/../output/5eb00ae79d25b/PDF32000_2008-69.html">step (a)</a>&#160;of&#160;<a href="src/../output/5eb00ae79d25b/PDF32000_2008-69.html">&#34;Algorithm 2: Computing an&#160;encryption&#160;<br/>key&#34;</a>.&#160;</p>
<p style="position:absolute;top:249px;left:106px;white-space:nowrap" class="ft02">f)</p>
<p style="position:absolute;top:249px;left:135px;white-space:nowrap" class="ft06">Encrypt the result&#160;of<a href="src/../output/5eb00ae79d25b/PDF32000_2008-71.html">&#160;step (e)</a>, using an RC4 encryption function&#160;with the&#160;encryption&#160;key&#160;obtained&#160;in<a href="src/../output/5eb00ae79d25b/PDF32000_2008-71.html">&#160;step&#160;<br/>(d).&#160;</a></p>
<p style="position:absolute;top:302px;left:106px;white-space:nowrap" class="ft02">g)</p>
<p style="position:absolute;top:302px;left:135px;white-space:nowrap" class="ft06"><i>(Security handlers&#160;of&#160;revision&#160;3 or&#160;greater)&#160;</i>Do&#160;the following&#160;19&#160;times: Take&#160;the&#160;output&#160;from&#160;the&#160;previous&#160;<br/>invocation&#160;of the RC4 function and&#160;pass it as input&#160;to&#160;a new invocation of&#160;the&#160;function; use&#160;an encryption&#160;<br/>key generated by&#160;taking each&#160;byte&#160;of&#160;the&#160;encryption&#160;key obtained<a href="src/../output/5eb00ae79d25b/PDF32000_2008-71.html">&#160;in&#160;step (d)</a>&#160;and performing&#160;an XOR&#160;<br/>(exclusive&#160;or) operation between&#160;that&#160;byte and&#160;the&#160;single-byte&#160;value of&#160;the&#160;iteration&#160;counter (from 1&#160;to&#160;19).&#160;</p>
<p style="position:absolute;top:389px;left:106px;white-space:nowrap" class="ft02">h)</p>
<p style="position:absolute;top:389px;left:135px;white-space:nowrap" class="ft06">Store the&#160;output from&#160;the final&#160;invocation&#160;of&#160;the RC4 function&#160;as&#160;the&#160;value of the&#160;<b>O</b>&#160;entry in the encryption&#160;<br/>dictionary.&#160;</p>
<p style="position:absolute;top:446px;left:106px;white-space:nowrap" class="ft07"><b>Algorithm 4:&#160;Computing the encryption dictionary’s&#160;U (user password) value&#160;(Security&#160;handlers of&#160;<br/>revision&#160;2)</b></p>
<p style="position:absolute;top:498px;left:106px;white-space:nowrap" class="ft02">a)</p>
<p style="position:absolute;top:498px;left:135px;white-space:nowrap" class="ft06">Create&#160;an&#160;encryption&#160;key based&#160;on&#160;the&#160;user&#160;password&#160;string,&#160;as described in&#160;<a href="src/../output/5eb00ae79d25b/PDF32000_2008-69.html">&#34;Algorithm&#160;2: Computing an&#160;<br/>encryption key&#34;</a>.&#160;</p>
<p style="position:absolute;top:551px;left:106px;white-space:nowrap" class="ft02">b)</p>
<p style="position:absolute;top:551px;left:135px;white-space:nowrap" class="ft06">Encrypt the 32-byte padding string&#160;shown&#160;in&#160;<a href="src/../output/5eb00ae79d25b/PDF32000_2008-69.html">step (a)&#160;of&#160;&#34;Algorithm&#160;2:&#160;Computing&#160;an&#160;encryption&#160;key&#34;</a>, using&#160;<br/>an RC4 encryption function with the encryption key from the&#160;preceding&#160;step.&#160;</p>
<p style="position:absolute;top:603px;left:106px;white-space:nowrap" class="ft02">c)</p>
<p style="position:absolute;top:603px;left:135px;white-space:nowrap" class="ft02">Store&#160;the&#160;result o<a href="src/../output/5eb00ae79d25b/PDF32000_2008-71.html">f&#160;step (b)</a>&#160;as&#160;the&#160;value&#160;of&#160;the&#160;<b>U</b>&#160;entry in the encryption dictionary.&#160;</p>
<p style="position:absolute;top:643px;left:106px;white-space:nowrap" class="ft07"><b>Algorithm 5:&#160;Computing the encryption dictionary’s&#160;U (user password) value&#160;(Security&#160;handlers of&#160;<br/>revision&#160;3 or&#160;greater)</b></p>
<p style="position:absolute;top:695px;left:106px;white-space:nowrap" class="ft02">a)</p>
<p style="position:absolute;top:695px;left:135px;white-space:nowrap" class="ft06">Create&#160;an&#160;encryption&#160;key based&#160;on&#160;the&#160;user&#160;password&#160;string,&#160;as described in&#160;<a href="src/../output/5eb00ae79d25b/PDF32000_2008-69.html">&#34;Algorithm&#160;2: Computing an&#160;<br/>encryption key&#34;</a>.&#160;</p>
<p style="position:absolute;top:748px;left:106px;white-space:nowrap" class="ft02">b)</p>
<p style="position:absolute;top:748px;left:135px;white-space:nowrap" class="ft06">Initialize the MD5 hash function&#160;and&#160;pass the 32-byte&#160;padding&#160;string&#160;sh<a href="src/../output/5eb00ae79d25b/PDF32000_2008-69.html">own in&#160;step (a)&#160;of&#160;&#34;Algorithm 2:&#160;<br/>Computing&#160;an&#160;encryption&#160;key&#34;&#160;as input&#160;</a>to this function.&#160;</p>
<p style="position:absolute;top:800px;left:106px;white-space:nowrap" class="ft02">c)</p>
<p style="position:absolute;top:800px;left:135px;white-space:nowrap" class="ft06">Pass&#160;the first&#160;element of the&#160;file’s file&#160;identifier&#160;array (the&#160;value of the&#160;<b>ID</b>&#160;entry&#160;in&#160;the document’s&#160;trailer&#160;<br/>dictionary; see<a href="src/../output/5eb00ae79d25b/PDF32000_2008-51.html">&#160;Table&#160;15) to t</a>he hash&#160;function and&#160;finish&#160;the hash.&#160;</p>
<p style="position:absolute;top:853px;left:106px;white-space:nowrap" class="ft02">d)</p>
<p style="position:absolute;top:853px;left:135px;white-space:nowrap" class="ft06">Encrypt the&#160;16-byte&#160;result of the&#160;hash, using an&#160;RC4&#160;encryption function&#160;with&#160;the encryption&#160;key fr<a href="src/../output/5eb00ae79d25b/PDF32000_2008-71.html">om&#160;step&#160;<br/>(a).&#160;</a></p>
<p style="position:absolute;top:905px;left:106px;white-space:nowrap" class="ft02">e)</p>
<p style="position:absolute;top:905px;left:135px;white-space:nowrap" class="ft06">Do&#160;the following&#160;19 times: Take&#160;the output from the&#160;previous invocation&#160;of the RC4&#160;function&#160;and pass it as&#160;<br/>input&#160;to&#160;a new invocation&#160;of&#160;the&#160;function; use an&#160;encryption&#160;key&#160;generated&#160;by taking&#160;each&#160;byte of&#160;the&#160;<br/>original encryption&#160;key&#160;obtained in&#160;<a href="src/../output/5eb00ae79d25b/PDF32000_2008-71.html">step&#160;(a)</a>&#160;and&#160;performing&#160;an&#160;XOR (exclusive or) operation between that&#160;<br/>byte&#160;and the single-byte&#160;value of&#160;the&#160;iteration counter (from&#160;1&#160;to&#160;19).&#160;</p>
<p style="position:absolute;top:992px;left:106px;white-space:nowrap" class="ft02">f)</p>
<p style="position:absolute;top:992px;left:135px;white-space:nowrap" class="ft06">Append&#160;16 bytes&#160;of arbitrary padding&#160;to the&#160;output from&#160;the final invocation&#160;of&#160;the&#160;RC4&#160;function&#160;and store&#160;<br/>the 32-byte result&#160;as&#160;the&#160;value of the&#160;<b>U</b>&#160;entry&#160;in&#160;the encryption dictionary.&#160;</p>
<p style="position:absolute;top:1045px;left:106px;white-space:nowrap" class="ft05">NOTE</p>
<p style="position:absolute;top:1045px;left:183px;white-space:nowrap" class="ft08">The&#160;standard&#160;security handler&#160;uses the&#160;algorithms&#160;6&#160;and 7&#160;that follow,&#160;to&#160;determine whether&#160;a supplied&#160;<br/>password&#160;string&#160;is&#160;the&#160;correct&#160;user&#160;or&#160;owner&#160;password.&#160;Note too that algorithm&#160;6&#160;can be used&#160;to determine&#160;<br/>whether&#160;a&#160;document’s&#160;user&#160;password is the&#160;empty string, and therefore&#160;whether to&#160;suppress prompting&#160;for a&#160;<br/>password&#160;when the document&#160;is opened.&#160;</p>
</div>
</body>
</html>
