<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
<title>Page 70</title>

<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft00{font-size:14px;font-family:Times;color:#000000;}
	.ft01{font-size:12px;font-family:Times;color:#000000;}
	.ft02{font-size:9px;font-family:Times;color:#000000;}
	.ft03{font-size:12px;font-family:Times;color:#000000;}
	.ft04{font-size:12px;font-family:Times;color:#000000;}
	.ft05{font-size:11px;font-family:Times;color:#000000;}
	.ft06{font-size:12px;line-height:21px;font-family:Times;color:#000000;}
	.ft07{font-size:12px;line-height:17px;font-family:Times;color:#000000;}
	.ft08{font-size:11px;line-height:13px;font-family:Times;color:#000000;}
-->
</style>
</head>
<body bgcolor="#A0A0A0" vlink="blue" link="blue">
<div id="page70-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="src/../output/5eb00ae79d25b/PDF32000_2008070.png" alt="background image"/>
<p style="position:absolute;top:63px;left:55px;white-space:nowrap" class="ft00"><b>PDF 32000-1:2008</b></p>
<p style="position:absolute;top:1197px;left:55px;white-space:nowrap" class="ft01">62</p>
<p style="position:absolute;top:1199px;left:341px;white-space:nowrap" class="ft02">©&#160;</p>
<p style="position:absolute;top:1196px;left:353px;white-space:nowrap" class="ft00"><b>Adobe&#160;Systems Incorporated 2008 –&#160;All&#160;rights reserved</b></p>
<p style="position:absolute;top:127px;left:115px;white-space:nowrap" class="ft01">&lt;&#160;&#160;28&#160;&#160;BF&#160;&#160;4E&#160;&#160;5E&#160;&#160;4E&#160;&#160;75&#160;&#160;8A&#160;&#160;41&#160;&#160;64&#160;&#160;00&#160;&#160;4E&#160;&#160;56&#160;&#160;FF&#160;&#160;FA&#160;&#160;01&#160;&#160;08</p>
<p style="position:absolute;top:123px;left:538px;white-space:nowrap" class="ft01">&#160;</p>
<p style="position:absolute;top:144px;left:115px;white-space:nowrap" class="ft01">&#160;2E&#160;&#160;2E&#160;&#160;00&#160;&#160;B6&#160;&#160;D0&#160;&#160;68&#160;&#160;3E&#160;&#160;80&#160;&#160;2F&#160;&#160;0C&#160;&#160;A9&#160;&#160;FE&#160;&#160;64&#160;&#160;53&#160;&#160;69&#160;&#160;7A&#160;&#160;&#160;&gt;</p>
<p style="position:absolute;top:140px;left:550px;white-space:nowrap" class="ft01">&#160;</p>
<p style="position:absolute;top:157px;left:84px;white-space:nowrap" class="ft07">&#160;<br/>That&#160;is, if the password string&#160;is&#160;<i>n</i>&#160;bytes long, append&#160;the&#160;first&#160;32&#160;-&#160;<i>n</i>&#160;bytes of&#160;the padding&#160;string&#160;to&#160;the&#160;end&#160;<br/>of the password string.&#160;If&#160;the&#160;password&#160;string is empty&#160;(zero-length),&#160;meaning&#160;there is no&#160;user&#160;password,&#160;<br/>substitute&#160;the entire&#160;padding&#160;string&#160;in its&#160;place.&#160;</p>
<p style="position:absolute;top:248px;left:55px;white-space:nowrap" class="ft01">b)</p>
<p style="position:absolute;top:248px;left:84px;white-space:nowrap" class="ft01">Initialize&#160;the MD5 hash&#160;function&#160;and&#160;pass the result of<a href="src/../output/5eb00ae79d25b/PDF32000_2008-69.html">&#160;step (a)</a>&#160;as input&#160;to this&#160;function.&#160;</p>
<p style="position:absolute;top:284px;left:55px;white-space:nowrap" class="ft01">c)</p>
<p style="position:absolute;top:284px;left:84px;white-space:nowrap" class="ft07">Pass the value of&#160;the&#160;encryption&#160;dictionary’s&#160;<b>O</b>&#160;entry to&#160;the&#160;MD5 hash&#160;fu<a href="src/../output/5eb00ae79d25b/PDF32000_2008-70.html">nction. (&#34;Algorithm 3:&#160;Computing&#160;<br/>the encryption dictionary’s&#160;O (owner&#160;password)&#160;value&#34;&#160;sh</a>ows&#160;how the&#160;<b>O</b>&#160;value&#160;is computed.)&#160;</p>
<p style="position:absolute;top:336px;left:55px;white-space:nowrap" class="ft01">d)</p>
<p style="position:absolute;top:336px;left:84px;white-space:nowrap" class="ft07">Convert the&#160;integer&#160;value&#160;of the&#160;<b>P</b>&#160;entry to a&#160;32-bit unsigned binary&#160;number&#160;and pass these bytes to the&#160;<br/>MD5 hash function, low-order&#160;byte&#160;first.&#160;</p>
<p style="position:absolute;top:389px;left:55px;white-space:nowrap" class="ft01">e)</p>
<p style="position:absolute;top:389px;left:84px;white-space:nowrap" class="ft07">Pass&#160;the first&#160;element of the&#160;file’s&#160;file&#160;identifier&#160;array (the&#160;value of the&#160;<b>ID</b>&#160;entry&#160;in&#160;the document’s&#160;trailer&#160;<br/>dictionary; see<a href="src/../output/5eb00ae79d25b/PDF32000_2008-51.html">&#160;Table&#160;15) to t</a>he MD5 hash&#160;function.&#160;</p>
<p style="position:absolute;top:441px;left:55px;white-space:nowrap" class="ft05">NOTE</p>
<p style="position:absolute;top:441px;left:132px;white-space:nowrap" class="ft08">The first element of&#160;the&#160;ID array generally&#160;remains the&#160;same for a&#160;given&#160;document. However,&#160;in&#160;some&#160;<br/>situations, conforming writers may regenerate&#160;the ID&#160;array if a new generation&#160;of&#160;a document is created.&#160;<br/>Security handlers are encouraged&#160;not&#160;to rely on the ID&#160;in&#160;the&#160;encryption key computation.</p>
<p style="position:absolute;top:498px;left:55px;white-space:nowrap" class="ft01">f)</p>
<p style="position:absolute;top:498px;left:84px;white-space:nowrap" class="ft07"><i>(Security handlers&#160;of revision&#160;4 or&#160;greater)&#160;</i>If document metadata&#160;is not being&#160;encrypted, pass 4 bytes with&#160;<br/>the value&#160;0xFFFFFFFF to&#160;the MD5 hash&#160;function.&#160;</p>
<p style="position:absolute;top:551px;left:55px;white-space:nowrap" class="ft01">g)</p>
<p style="position:absolute;top:551px;left:84px;white-space:nowrap" class="ft01">Finish the hash.</p>
<p style="position:absolute;top:586px;left:55px;white-space:nowrap" class="ft01">h)</p>
<p style="position:absolute;top:586px;left:84px;white-space:nowrap" class="ft07"><i>(Security handlers&#160;of&#160;revision&#160;3 or&#160;greater)&#160;</i>Do the&#160;following 50&#160;times: Take&#160;the&#160;output from&#160;the&#160;previous&#160;<br/>MD5&#160;hash&#160;and pass&#160;the&#160;first&#160;<i>n</i>&#160;bytes&#160;of the&#160;output as input&#160;into&#160;a new MD5&#160;hash,&#160;where&#160;<i>n</i>&#160;is the number&#160;of&#160;<br/>bytes of&#160;the encryption&#160;key as defined&#160;by the value&#160;of&#160;the&#160;encryption&#160;dictionary’s&#160;<b>Length</b>&#160;entry.&#160;</p>
<p style="position:absolute;top:656px;left:55px;white-space:nowrap" class="ft01">i)</p>
<p style="position:absolute;top:656px;left:84px;white-space:nowrap" class="ft07">Set&#160;the encryption key&#160;to the&#160;first&#160;<i>n</i>&#160;bytes&#160;of the output from&#160;the&#160;final MD5 hash, where&#160;<i>n</i>&#160;shall always&#160;be&#160;5&#160;<br/>for security&#160;handlers&#160;of revision&#160;2&#160;but, for security&#160;handlers&#160;of&#160;revision&#160;3&#160;or&#160;greater, shall depend&#160;on&#160;the&#160;<br/>value of&#160;the encryption&#160;dictionary’s&#160;<b>Length</b>&#160;entry.<b>&#160;</b></p>
<p style="position:absolute;top:725px;left:55px;white-space:nowrap" class="ft07">This algorithm, when&#160;applied&#160;to&#160;the&#160;user&#160;password&#160;string, produces&#160;the&#160;encryption&#160;key used&#160;to&#160;encrypt or&#160;<br/>decrypt&#160;string&#160;and stream data&#160;accord<a href="src/../output/5eb00ae79d25b/PDF32000_2008-66.html">ing to&#160;&#34;Algorithm 1: Encryption of data&#160;using the RC4 or AES algorithms&#34;<br/></a>in&#160;&#160;<a href="src/../output/5eb00ae79d25b/PDF32000_2008-65.html">7.6.2, &#34;General&#160;Encryption&#160;Algorithm.&#34;</a>&#160;Parts of&#160;this algorithm&#160;are also&#160;used&#160;in the algorithms described&#160;<br/>below.&#160;</p>
<p style="position:absolute;top:817px;left:55px;white-space:nowrap" class="ft04"><b>7.6.3.4</b></p>
<p style="position:absolute;top:817px;left:119px;white-space:nowrap" class="ft04"><b>Password Algorithms</b></p>
<p style="position:absolute;top:852px;left:55px;white-space:nowrap" class="ft07">In&#160;addition&#160;to&#160;the&#160;encryption&#160;key,&#160;the&#160;standard&#160;security&#160;handler&#160;shall provide the&#160;contents&#160;of&#160;the&#160;encryption&#160;<br/>dictiona<a href="src/../output/5eb00ae79d25b/PDF32000_2008-64.html">ry (Table&#160;20&#160;a</a><a href="src/../output/5eb00ae79d25b/PDF32000_2008-68.html">nd&#160;Table&#160;21</a>).&#160;The&#160;values of&#160;the&#160;<b>Filter</b>,&#160;<b>V</b>,&#160;<b>Length</b>,&#160;<b>R</b>, and&#160;<b>P</b>&#160;entries are straightforward,&#160;but&#160;<br/>the computation&#160;of the&#160;<b>O</b>&#160;(owner password) and&#160;<b>U</b>&#160;(user&#160;password)&#160;entries requires further explanation. The&#160;<br/>algorithms&#160;3&#160;through 7&#160;that follow show how the values&#160;of the&#160;owner password&#160;and user&#160;password&#160;entries shall&#160;<br/>be computed&#160;(with&#160;separate versions of&#160;the&#160;latter&#160;depending&#160;on the&#160;revision of the security handler).&#160;</p>
<p style="position:absolute;top:961px;left:55px;white-space:nowrap" class="ft04"><b>Algorithm 3:&#160;Computing the encryption&#160;dictionary’s&#160;O (owner&#160;password)&#160;value</b></p>
<p style="position:absolute;top:996px;left:55px;white-space:nowrap" class="ft01">a)</p>
<p style="position:absolute;top:996px;left:84px;white-space:nowrap" class="ft07">Pad or&#160;truncate the&#160;owner password&#160;string&#160;as described&#160;in&#160;<a href="src/../output/5eb00ae79d25b/PDF32000_2008-69.html">step (a)&#160;of&#160;&#34;Algorithm 2:&#160;Computing an&#160;<br/>encryption key&#34;</a>. If there is&#160;no&#160;owner password, use the user&#160;password&#160;instead.&#160;</p>
<p style="position:absolute;top:1049px;left:55px;white-space:nowrap" class="ft01">b)</p>
<p style="position:absolute;top:1049px;left:84px;white-space:nowrap" class="ft01">Initialize&#160;the MD5 hash&#160;function&#160;and&#160;pass the result of<a href="src/../output/5eb00ae79d25b/PDF32000_2008-70.html">&#160;step (a)</a>&#160;as input&#160;to this&#160;function.&#160;</p>
<p style="position:absolute;top:1084px;left:55px;white-space:nowrap" class="ft01">c)</p>
<p style="position:absolute;top:1084px;left:84px;white-space:nowrap" class="ft07"><i>(Security handlers&#160;of&#160;revision&#160;3 or&#160;greater)&#160;</i>Do the&#160;following 50&#160;times: Take&#160;the&#160;output from&#160;the&#160;previous&#160;<br/>MD5 hash and pass it as&#160;input into a new&#160;MD5&#160;hash.&#160;</p>
</div>
</body>
</html>
